html
  head
    title Edit Profile | Taro Cards
    link(rel='icon' href='../assets/TaroCardTransparent 1.png')
    link(rel='preconnect' href='https://fonts.googleapis.com')
    link(rel='preconnect' href='https://fonts.gstatic.com' crossorigin)
    link(href='https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap' rel='stylesheet')
    script(src='../jquery-3.6.0.min.js')
    link(rel='stylesheet' href='../temp.css')
  body.edit-page(style='margin-top: 150px;')
    .edit
      form#edit(action='/edit/profile' onsubmit='submitImages()' method='POST')
        .banner
          img#banner(src='/banner')
          label#imgInputBanner.upload-img-a(for='inputBanner')
            img#upload-banner.upload-img(src='../assets/upload-img-circle.png')
            // <i style="color: blue;" class="fa fa-camera fa-5x" aria-hidden="false"></i>
          input#inputBanner(type='file' name='Banner' accept='.jpg, .png, .gif')
        .pfp
          img#profilePic(src='/pfp')
          label#imgInputProfilePic.upload-img-a(for='inputProfilePic')
            img#upload-pfp.upload-img(src='../assets/upload-img-circle.png')
            // <i style="color: red;" class="fa fa-camera fa-3x" aria-hidden="true"></i>
          input#inputProfilePic(type='file' name='Profile-Pic' accept='.jpg, .png, .gif')
        // Values will be whatever the user's current username/bio/etc is
        // proper pug code is commented under html equivalents, autogenerated pug code does not work
        .text-input
          label.label(for='display-name') Display Name
          br
          input#display-name.edit-input(type='text' name='display-name' value='' + displayName)
          br
          // input#display-name.edit-input(type='text' name='display-name' value= '' + displayName)
          label.label(for='username') Username
          br
          input#usernameEdit.edit-input(type='text' name='username' value='' + username)
          br
          // input#usernameEdit.edit-input(type='text' name='username' value='' + username)
          label.label(for='bio') Bio
          br
          textarea#bio.edit-input(name='bio' maxlength='150' value='' + bio placeholder='' + bio)
          // textarea#bio.edit-input(name='bio' maxlength='150' value=''+bio placeholder=''+bio)
          br
          input#save(type='submit' value='Save changes')
    script.
      $("#inputBanner").change(function(event) {
      alert("You choose: " + event.target.value + " as your Banner.");
      let currentBanner = document.getElementById("banner");
      var tmppath = URL.createObjectURL(event.target.files[0]);
      currentBanner.src = tmppath;
      })
      
      $("#inputProfilePic").change(function(event) {
      alert("You choose: " + event.target.value + " as your Profile Picture.");
      let currentProfilePic = document.getElementById("profilePic");
      var tmppath = URL.createObjectURL(event.target.files[0]);
      currentProfilePic.src = tmppath;
      })
      
      $('#bio').keypress(function(event) {
      if (event.keyCode == 13) {
      event.preventDefault();
      }
      });
      
      async function sendProfilePicture() {
      let fileInput = document.querySelector('#inputProfilePic')
      
      const formData  = new FormData();
      formData.append("Profile-Pic", fileInput.files[0]);
      
      var xhr = new XMLHttpRequest();
      xhr.open("POST", "/upload/avatar", true);
      xhr.send(formData);
      }
      
      async function sendBanner() {
      let fileInput = document.querySelector('#inputBanner')
      
      const formData  = new FormData();
      formData.append("Banner", fileInput.files[0]);
      
      var xhr = new XMLHttpRequest();
      xhr.open("POST", "/upload/banner", true);
      xhr.send(formData);
      }
      
      async function submitImages () {
      sendProfilePicture()
      sendBanner()
      }
