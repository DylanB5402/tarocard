<head>
    <title>Edit Profile | Taro Cards</title>
    <link rel="icon" href="../assets/TaroCardTransparent 1.png" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="crossorigin" />
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&amp;display=swap" rel="stylesheet" />
    <script src="../jquery-3.6.0.min.js"></script>
    <link rel="stylesheet" href="../temp.css" />
</head>
<div class="page-header"><a href="/profile"><img id="back" src="../assets/Back.png" /></a><span>Edit Profile</span></div>
<div class="edit">
    <form id="edit" action="/edit/profile" onsubmit="submitImages()" method="POST">
        <div class="banner"><img id="banner" src="/banner" /><label class="upload-img-a" id="imgInputBanner" for="inputBanner"><img class="upload-img" id="upload-banner" src="../assets/upload-img-circle.png" /><!-- <i style="color: blue;" class="fa fa-camera fa-5x" aria-hidden="false"></i>--></label><input id="inputBanner" type="file" name="Banner" accept=".jpg, .png, .gif" /></div>
        <div class="pfp"><img id="profilePic" src="/pfp" /><label class="upload-img-a" id="imgInputProfilePic" for="inputProfilePic"><img class="upload-img" id="upload-pfp" src="../assets/upload-img-circle.png" /><!-- <i style="color: red;" class="fa fa-camera fa-3x" aria-hidden="true"></i>--></label><input id="inputProfilePic" type="file" name="Profile-Pic" accept=".jpg, .png, .gif" /></div><!-- Values will be whatever the user's current username/bio/etc is-->
        <!-- proper pug code is commented under html equivalents, autogenerated pug code does not work-->
        <div class="text-input"><label class="label" for="display-name">Display Name</label><br /><input class="edit-input" id="display-name" type="text" name="display-name" value="undefined" /><br /><!-- input#display-name.edit-input(type='text' name='display-name' value= '' + displayName)--><label class="label" for="username">Username</label><br /><input class="edit-input" id="usernameEdit" type="text" name="username" value="undefined" /><br /><!-- input#usernameEdit.edit-input(type='text' name='username' value='' + username)--><label class="label" for="bio">Bio</label><br /><textarea class="edit-input" id="bio" name="bio" maxlength="150" value="undefined" placeholder="undefined"></textarea><!-- textarea#bio.edit-input(name='bio' maxlength='150' value=''+bio placeholder=''+bio)--><br /><input id="save" type="submit" value="Save changes" /></div>
    </form>
</div>
<script>
    $("#inputBanner").change(function(event) {
        const file = event.target;
        let fileSize = file.files.item(0).size
        fileSize = Math.round((fileSize / 1024));
        if(fileSize > 4096) {
            alert("Your file must be no larger than 4mb")
            event.target.value = "";
        }
        else {
            alert("You choose: " + event.target.value + " as your Banner.");
            let currentBanner = document.getElementById("banner");
            var tmppath = URL.createObjectURL(event.target.files[0]);
            currentBanner.src = tmppath;
        }
    })
    $("#inputProfilePic").change(function(event) {
        const file = event.target;
        let fileSize = file.files.item(0).size
        fileSize = Math.round((fileSize / 1024));
        if(fileSize > 4096) {
            alert("Your file must be no larger than 4mb")
            event.target.value = "";
        }
        else {
            alert("You choose: " + event.target.value + " as your Profile Picture.");
            let currentProfilePic = document.getElementById("profilePic");
            var tmppath = URL.createObjectURL(event.target.files[0]);
            currentProfilePic.src = tmppath;
        }
    })
    $('#bio').keypress(function(event) {
        if (event.keyCode == 13) {
            event.preventDefault();
        }
    });

    function sendProfilePicture() {
        let fileInput = document.querySelector('#inputProfilePic')
        const formData = new FormData();
        formData.append("Profile-Pic", fileInput.files[0]);
        var xhr = new XMLHttpRequest();
        xhr.open("POST", "/upload/avatar", true);
        xhr.send(formData);
    }

    function sendBanner() {
        let fileInput = document.querySelector('#inputBanner')
        const formData = new FormData();
        formData.append("Banner", fileInput.files[0]);
        var xhr = new XMLHttpRequest();
        xhr.open("POST", "/upload/banner", true);
        xhr.send(formData);
    }

    function submitImages() {
        sendProfilePicture()
        sendBanner()
    }

    let bannerInput = document.getElementById("edit").querySelector("#inputBanner")
    let 
</script>